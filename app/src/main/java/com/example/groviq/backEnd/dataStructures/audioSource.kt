package com.example.groviq.backEnd.dataStructures

import com.example.groviq.backEnd.searchEngine.ArtistDto
import java.util.Calendar
import java.util.concurrent.TimeUnit


data class audioSource(

    var nameOfAudioSource     : String = "",
    var artistsOfAudioSource  : List<ArtistDto> = emptyList(),
    var yearOfAudioSource     : String = "",
    var songIds: MutableList<String> = mutableListOf(),

    //params that make audiosource be saved by user
    var shouldBeSavedStrictly : Boolean = false,

    //autogenerated
    var autoGenerated   : Boolean = false,
    var timeUpdate      : Long = 0L
){
    private var cachedMidnight: Long = 0
    private var cachedDay: Int = -1

    fun shouldBeRegenerated(): Boolean {

        val cal = Calendar.getInstance()

        val today = cal.get(Calendar.DAY_OF_YEAR)
        if (today != cachedDay) {
            cal.set(Calendar.HOUR_OF_DAY, 0)
            cal.set(Calendar.MINUTE, 0)
            cal.set(Calendar.SECOND, 0)
            cal.set(Calendar.MILLISECOND, 0)
            cachedMidnight = cal.timeInMillis
            cachedDay = today
        }

        return timeUpdate < cachedMidnight
    }
}
